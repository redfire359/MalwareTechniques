# Decoding Shellcode

MITRE ATT&CK ID: T1027.013

Encoding files can obfuscate strings and impede detection. Encrypting content aims to conceal malicious artifacts within a file.

This section has 2 files, one is the .c file used to decode an AES encoded `msfvenom` payload that spawns calc.exe. The other is a python file used to generate random key and IV strings. Note these payloads are still heavily signatured, but they disguise the actual instructions the shellcode is going to execute. (For example, this program usually gets 26/71 on Virustotal, while an unencrypted one gets 41/71)

Both can be compiled on linux with the mingw-64 binary. Compilation instrucitons are at the top of each .c file.

```bash
sudo apt install gcc-mingw-w64 
```

## Further Reading

AES / padding functions were utilized from these repos:

- [kokke's tiny-AES-c](https://github.com/kokke/tiny-AES-c)

- [bonybrown's tiny-AES-c's fork, which includes pkcs7 paddings](https://github.com/bonybrown/tiny-AES128-C)

- [AES wiki page](https://en.wikipedia.org/wiki/Advanced_Encryption_Standard)

- [MITRE ATT&CK Technique - Encrypted/Encoded File](https://attack.mitre.org/techniques/T1027/013/)
